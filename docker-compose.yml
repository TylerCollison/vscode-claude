version: '3.8'

services:
  claude-dev:
    build: .
    container_name: claude-dev
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Etc/UTC
      - PASSWORD=password # optional
      - HASHED_PASSWORD= # optional
      - SUDO_PASSWORD=password # optional
      - SUDO_PASSWORD_HASH= # optional
      - PROXY_DOMAIN=code-server.my.domain # optional
      - DEFAULT_WORKSPACE=/workspace # optional
      - PWA_APPNAME=code-server # optional
      # Claude Code permission settings
      - CLAUDE_CODE_PERMISSION_MODE=acceptEdits
      - CLAUDE_CODE_FULL_PERMISSIONS=0
      - CLAUDE_CODE_ENABLE_TELEMETRY=0
      - CLAUDE_CODE_HIDE_ACCOUNT_INFO=1
      - DISABLE_ERROR_REPORTING=1
      - DISABLE_TELEMETRY=1
      - BASH_DEFAULT_TIMEOUT_MS=120000
      - BASH_MAX_TIMEOUT_MS=300000
    ports:
      - "8443:8443"
    volumes:
      - claude-config:/config
      - ./workspace:/workspace
    restart: unless-stopped

volumes:
  claude-config: